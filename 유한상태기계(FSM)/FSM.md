# 유한 상태 기계 (FSM)
#### 유한 상태 기계 (이하 FSM) 이란?
· 자신이 취할 수 있는 상태를 가진다.  
· 그 중에서 반드시 한 가지의 상태만을 취한다.  
· 가능한 상태의 집합과 그 전이 조건으로 정의된다.  
· 상태들의 노드와 그 노드들의 전이 조건인 간선으로 표현할 수 있다. (그래프 자료구조와 일맥상통)  
#### 유니티 애니메이션 컨트롤러와 1:1 대응
· 자신이 취할 수 있는 상태(State)을 가진다.  
· 그 중 한가지 상태(State)만 취한다.  
· 가능한 상태(State)의 집합과 그 전이 조건 (트랜지션, Transition)으로 정의된다.  
· 상태(State)들의 노드와 그 노드들의 전이 조건(트랜지션, Transition)인 간선으로 표현 가능하다.  
#### 사용하는 이유
· 가능한 동작들이 명확하게 나타나있다.  
· 상태가 중복되지 않는다.  
· 상태 전이가 명확하다.  
· 동작이 분명하게 규정된다.
· 프로그래밍에 이용시 안정적이다.
#### 대표적인 예, 전구
· 전구는 On, Off 상태를 가진다.  
· 반드시 둘 중 하나의 상태만을 가진다.  
· 각 상태는 전이 조건(스위치 올림/내림)에 의해 변이된다.  

전구는 다음과 같이 정의된다.  
On : 스위치가 올라가면 Off상태로 전이  
Off : 스위치가 내려가면 On상태로 전이
##### 작성자의 예전 코드를 예로 들어보자.
https://github.com/Gengaozo/UnitySkillAndGameMathTIL/blob/master/SourceCode/Unity%20Coroutine%20FSM%20(Noob)/FSM.cs

· idle, walk, run, skill_1 상태를 가짐.  
· 반드시 그 중 하나의 상태만을 가짐.  
· 각 상태는 전이 조건에 의해 변이  

다음과 같이 정의된다.  
(단, 상태 애니메이션이 모두 끝난 후 전이 조건 충족 시 전이 가능)

idle : 게임 시작 시 또는 skill_1 애니메이션 시작 전 run 상태가 아니고, isFixed가 false일 때 skill_1 애니메이션이 끝난 후 전이  
walk : idle에서 isFixed가 false일 경우, 이동 키를 눌렀을 시 전이  
run : skill_1 상태를 제외한 상태일 때 isFixed가 true일 때, 혹은 walk 상태가 2초 이상 지속될 때, skill_1 애니메이션 시작 전 run 상태일 때 또는 isFixed가 true일 때 skill_1 애니메이션이 끝난 후 전이  
skill_1 : skill_1 상태를 제외한 상태일 때 공격 키를 눌렀을 시 전이  

#### 객체 지향 프로그래밍에서의 활용
· 각 상태들을 추상 클래스로 만든다.  
· 상태들을 인터페이스로 규정시키고, 실제 동작은 상태별로 다르게 구현시킨다.  
· FSM을 가진 객체는 현재 상태를 내부 변수로 갖고 있어야 한다.  
· 상태들의 인터페이스를 이용해 상태들을 동작시킨다.
· 전이 조건 발생 시 FSM을 가진 객체는 조건에 맞는 다음 상태로 전이시킨다.
